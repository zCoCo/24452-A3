% Simulates the vibrations of a 1-DOF 2nd order system subject to initial 
% conditions q0 = [x0,v0], given its three coefficient dynamic properties 
% (m,k,c) or their rotational equivalents (J,k,b) and a forcing function,
% u(t).
% 
function [xs, vs, tspan] = free_vib(m,k,c, u, q0)
    % State-Space Representation of Second Order System:
    function dqdt = secondorder(t,q, m,c,k, u)
        A = [0 1; -k/m -c/m];
        B = [0; 1/m];
        dqdt = A*q + B*u(t);
    end

    wn = sqrt(k/m);
    z = c / m / 2 / wn;
    ts = 4.6 / z / wn; % 1% Settling Time for Underdamped system
    tspan = 0:0.001:ts;
    [t,q] = ode45(@(t,q) secondorder(t,q, m,c,k,u),tspan,q0);
    
    % Extract Results:
    xs = q(:,1);
    vs = q(:,2);
end
